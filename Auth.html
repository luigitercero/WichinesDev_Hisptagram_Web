<!DOCTYPE html>
<html lang="en">

<head>
    <title></title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="css/style.css" rel="stylesheet">


    <meta content="">
    <style></style>
    <!--AngularJS-->
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.7.5/angular.min.js"></script>
    <!--firebase auth to db-->
    <script src="https://www.gstatic.com/firebasejs/5.5.6/firebase.js"></script>
    <script>
        // Initialize Firebase
        var config = {
            apiKey: "AIzaSyDtcfiG8xKUnspkThSUnr3-ulGUvZjcgAo",
            authDomain: "deep-pursuit-174322.firebaseapp.com",
            databaseURL: "https://deep-pursuit-174322.firebaseio.com",
            projectId: "deep-pursuit-174322",
            storageBucket: "deep-pursuit-174322.appspot.com",
            messagingSenderId: "595740310600"
        };
        firebase.initializeApp(config);
    </script>
    <script src="https://cdn.firebase.com/libs/angularfire/2.3.0/angularfire.min.js"></script>
    <!--jQuery-->
    <script src="js/jquery-3.3.1.min.js"></script>
    <!---->
    <script src="js/index.js"></script>

    <!---->
    <!--Import Google Icon Font-->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <!--Import materialize.css-->
    <link type="text/css" rel="stylesheet" href="css/materialize.min.css" media="screen,projection" />

    <!--Let browser know website is optimized for mobile-->
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
</head>

<body ng-controller="ctrl">
    <script src="js/materialize.min.js"></script>
    <div class="container">
        <div id="login-page" class="row">
            <div class="col s5 offset-s3 z-depth-6 card-panel">
                <form class="login-form">
                    <div class="row">
                    </div>
                    <div class="row">
                        <div class="input-field col s12">
                            <i class="material-icons prefix">mail_outline</i>
                            <input class="validate" id="txtEmail" type="email">
                            <label for="email" data-error="wrong" data-success="right">Email</label>
                        </div>
                    </div>
                    <div class="row">
                        <div class="input-field col s12">
                            <i class="material-icons prefix">lock_outline</i>
                            <input id="txtPassWord" type="password">
                            <label for="password">Password</label>
                        </div>
                    </div>

                    <div class="row">
                        <div class="input-field col s12">
                            <a href="#" id='btnLogin' class="btn waves-effect waves-light col s12">Login</a>
                        </div>
                        <div class="input-field col s12">
                            <a href="#" id='btnLogout' class="btn waves-effect waves-light col s12">Logout</a>
                        </div>
                    </div>
                    <div class="row">
                        <div class="input-field col s6 m6 l6">
                            <p class="margin medium-small"><a id='btnRegister' href="#">Register Now!</a></p>
                        </div>
                        <div class="input-field col s6 m6 l6">
                            <p class="margin right-align medium-small"><a href="#">Forgot password?</a></p>
                        </div>
                    </div>

                </form>
            </div>
        </div>
    </div>
    <script>
        const txtEmail = document.getElementById('txtEmail');
        const txtPassWord = document.getElementById('txtPassWord');
        const btnLogin = document.getElementById('btnLogin');
        const btnRegister = document.getElementById('btnRegister');
        const btnLogout = document.getElementById('btnLogout');
        btnLogin.addEventListener('click', e => {
            const email = txtEmail.value;
            const clave = txtPassWord.value;
            const auth = firebase.auth();
            const promise = auth.signInWithEmailAndPassword(email, clave);
            promise.catch(e => console.log(e.message));
        })
        btnRegister.addEventListener('click', e => {
            const email = txtEmail.value;
            const clave = txtPassWord.value;
            const auth = firebase.auth();
            const promise = auth.createUserWithEmailAndPassword(email, clave);
            promise.catch(e => console.log(e.message));
        })

        btnLogout.addEventListener('click', e => {
            firebase.auth().signOut();
        })

        firebase.auth().onAuthStateChanged(firebaseUser => {
            if (firebaseUser) {
                console.log(firebaseUser);
                btnLogout.classList.remove('hide');
            } else {
                console.log('no Logueado');
                btnLogout.classList.add('hide')
            }
        });
    </script>
</body>

</html>